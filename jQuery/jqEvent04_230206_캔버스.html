<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>jQueryEvent</title>
<script src="js/jquery-3.6.3.min.js"></script>
<style>
    #canvas{
        border: 3px solid;
        margin-top: 10px;
    }
    .clear{
        position: relative;
        top: 3px;
        display: inline-block;
        border: 3px dashed #777;
        width: 15px;
        height: 15px;
    }
</style>
<script>
$(function() {
    /* ë³€ìˆ˜ */
    let position, x, y;
    let can = document.getElementById('canvas');
    let context = can.getContext('2d');
    let sw = false;
    
    /* ë‘ê»˜ ë³€ê²½ */
    let lineWidth = 10;
    $('select').change(function() {
        lineWidth = $('select>option:selected').val();
    });

    /* ìƒ‰ê¹” ë³€ê²½ */
    let color = '#000';
    $('.colorChange').change(function() {
        color = $(this).val();
        // alert(color);
    });

    /* ë„í™”ì§€ ì´ˆê¸°í™” */
    $('button').click(function() {
        can.width = can.width;
    }); 

    /* ì§€ìš°ê°œ */
    let oldColor, oldLineWidth;
    let clearSW = false;
    $('.clear').click(function() {
        clearSW = !clearSW;
        if(clearSW){
            $(this).css('border' ,'3px solid black');
            $(can).css('cursor', 'grabbing');
            oldColor = color;
            oldLineWidth = lineWidth;
            color = '#fff';
            lineWidth = 20;
        } else{
            $(this).css('border','3px dashed #777');
            $(can).css('cursor','default');
            color = oldColor;
            lineWidth = oldLineWidth;
        }
    });


    $(can).on({
        mousedown: function(event) {
            // console.log('ìº”ë²„ìŠ¤ ìœ„ì—ì„œ ë§ˆìš°ìŠ¤ ëˆŒë €ìŠµë‹ˆë‹¤.')
            sw = true;
            position = $(this).offset();
            //x = ë‚´ê°€ ëˆ„ë¥¸ ìœ„ì¹˜ì˜ ë¸Œë¼ìš°ì €ìƒ xê°’ - ìº”ë²„ìŠ¤ê°€ ë¸Œë¼ìš°ì €ì—ì„œ ê°–ê³  ìˆëŠ” xê°’ = ëˆ„ë¥¸ ê°’ì´ ìº”ë²„ìŠ¤ì—ì„œ ì°¨ì§€í•˜ëŠ” ê°’.
            x = event.pageX - position.left;
            y = event.pageY - position.top;  
            //.beginPath() : ì¢Œí‘œ ì‹œì‘
            context.beginPath();        
            context.moveTo(x,y);
        },
        mousemove: function(event) {
            // console.log('ìº”ë²„ìŠ¤ ìœ„ì—ì„œ ëŒì•„ë‹¤ë‹ˆê³  ìˆìŠµë‹ˆë‹¤.')
            if(sw){
                // ë§ˆìš°ìŠ¤ë¥¼ ì›€ì§ì´ë©´ì„œ ë°”ë€ŒëŠ” ì¢Œí‘œë¥¼ ë‹¤ì‹œ êµ¬í•¨
                position = $(this).offset();
                x = event.pageX - position.left;
                y = event.pageY - position.top;  
                context.lineWidth = lineWidth;
                context.strokeStyle = color;
                context.lineTo(x,y);        //ë§ˆìš°ìŠ¤ ì›€ì§ì´ëŠ” ê²ƒ ë”°ë¼ì„œ ìœ„ì¹˜ê°€ ì´ë™ë¨
                context.stroke();           //ìŠ¤íŠ¸ë¡œí¬ ë°©ì‹ì²˜ëŸ¼ ë¼ì¸ì„ ê·¸ë ¤ì¤Œ.
            }
        },
        mouseup: function(event) {
            // console.log('ìº”ë²„ìŠ¤ ìœ„ì—ì„œ ë§ˆìš°ìŠ¤ ë—ìŠµë‹ˆë‹¤.')
            sw = false;
        }
    });
});
</script>
</head>
<body>
    <p>ğŸ“ƒë‚™ì„œì¥ğŸ“’</p>
    <span>ë¶“ì˜ ë‘ê»˜</span>
    <select>
        <option>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>5</option>
        <option>6</option>
        <option>7</option>
        <option>8</option>
        <option>9</option>
        <option selected>10</option>
        <option>11</option>
        <option>12</option>
    </select>
    <span>ë¶“ì˜ ìƒ‰ìƒ</span>
    <input type="color" class="colorChange">
    <span>ì§€ìš°ê°œ</span>
    <div class="clear"></div><br>
    <button>ìƒˆ ë„í™”ì§€</button>
    <canvas id="canvas" width="800" height="500"></canvas>
</body>
</html>